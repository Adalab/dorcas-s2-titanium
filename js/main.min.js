'use strict';

var maxHabilidades = 3;
var numActualHabilidades = 1;
var habilidades = [];
var optionHabilidades = document.querySelector('.select__habilidades');
var buttonAddSelect = document.querySelector('.button__add-select');
buttonAddSelect.addEventListener('click', createSelect);
var fieldsetSelects = document.querySelector('.fieldset__div--habilidades-new');
var currentSelect;


function loadSelect() {
  fetch('https://raw.githubusercontent.com/Adalab/dorcas-s2-proyecto-data/master/skills.json')
    .then(function(listado) {

      return listado.json();
    })
    .then(function(listadoJSON) {

      habilidades = listadoJSON.skills;
      habilidades2options()
    });
}

function habilidades2options() {
  var optionElement;
  var optionText;
  var selectHabilidades = document.querySelectorAll('.select__habilidades');

  for (var j = 0; j < selectHabilidades.length; j++) {

    currentSelect = selectHabilidades[j];

    for (var i = 0; i < habilidades.length; i++) {
      optionElement = document.createElement('option');
      optionElement.value = habilidades[i];
      optionText = document.createTextNode(habilidades[i]);
      optionElement.appendChild(optionText);

      currentSelect.appendChild(optionElement);
    }
    var currentSelectNumber = j + 1;
    currentSelect.name = 'Habilidade' + currentSelectNumber;

    if (currentSelect.getAttribute('data-eventlistener') !== 'true') {

      currentSelect.addEventListener('change', guardarDataLSSelect); // para localStorage
      currentSelect.setAttribute('data-eventlistener', true);
    }
  }
}

function createSelect() {

  if (numActualHabilidades === maxHabilidades) {
    return false;
  } else {
    numActualHabilidades++;

    var createSelectDiv = document.createElement('div');
    createSelectDiv.classList.add('div__habilidades');
    var createSelectSelect = document.createElement('select');
    createSelectSelect.classList.add('select__habilidades', 'select__habilidades' + numActualHabilidades);

    var createSelectDivIcon = document.createElement('div');
    createSelectDivIcon.classList.add('button__add-select--container');
    var createSelectIcon = document.createElement('i');

    createSelectIcon.classList.add('fas', 'fa-plus', 'button__add-select', 'button__add-select' + numActualHabilidades);

    createSelectDivIcon.appendChild(createSelectIcon);
    createSelectDiv.append(createSelectSelect, createSelectDivIcon);

    fieldsetSelects.appendChild(createSelectDiv);

    habilidades2options();

    addButtonsEvents();
  }
}

function addButtonsEvents() {

  var buttonsAddSelect = document.querySelectorAll('.button__add-select');

  for (var w = 0; w < buttonsAddSelect.length; w++) {

    var buttonRemove = numActualHabilidades - 1;

    buttonsAddSelect[w].removeEventListener('click', createSelect);
    buttonsAddSelect[w].removeEventListener('click', removeSelect);
    buttonsAddSelect[w].parentElement.classList.remove('hide');


    if (buttonsAddSelect[w].classList.contains('button__add-select' + buttonRemove)) {
      buttonsAddSelect[w].classList.remove('fa-plus');
      buttonsAddSelect[w].classList.add('fa-minus');
      buttonsAddSelect[w].addEventListener('click', removeSelect);
    } else {
      if (numActualHabilidades === 3 && buttonsAddSelect[w].classList.contains('button__add-select1')) {
        buttonsAddSelect[w].parentElement.classList.add('hide');
      } else {
        buttonsAddSelect[w].addEventListener('click', createSelect);
        buttonsAddSelect[w].classList.add('fa-plus');
        buttonsAddSelect[w].classList.remove('fa-minus');
      }
    }
  }
}


function removeSelect() {

  numActualHabilidades--;
  fieldsetSelects.lastChild.remove();
  if (numActualHabilidades === 2) {
    habilidade3LocalStorage = '';
  } else if (numActualHabilidades === 1) {
    habilidade2LocalStorage = '';
  }
  guardarDataLS()
  addButtonsEvents()
}

// loadSelect();
'use strict';

var mobileLink = document.querySelector('.mobileLink');
var emailLink = document.querySelector('.emailLink');
var linkedinLink = document.querySelector('.linkedinLink');
var githubLink = document.querySelector('.githubLink');

var inputEmail = document.querySelector('.fieldset__rellena--input-email');
var inputTelefono = document.querySelector('.fieldset__rellena--input-mobile');
var inputLinkedin = document.querySelector('.fieldset__rellena--input-linkedin');
var inputGithub = document.querySelector('.fieldset__rellena--input-github');


var contact = document.querySelector('.contact');

contact.addEventListener('keyup', showIcon);

// TODO: llamar localStorage //


function showIcon(event) {
  if (event.target !== event.currentTarget) {

    var guilty = event.target.className;
    var changeIcon;

    if (guilty.indexOf('email') >= 0) {
      var email2Link = event.target.value;
      emailLink.href = 'mailto:' + email2Link;
      changeIcon = 'email';

    } else if (guilty.indexOf('mobile') >= 0) {
      var mobile2Link = event.target.value;
      mobileLink.href = 'tel:' + mobile2Link;
      changeIcon = 'mobile';

    } else if (guilty.indexOf('linkedin') >= 0) {
      var linkedin2Link = event.target.value;
      linkedinLink.href = 'http://linkedin.com/in/' + linkedin2Link;
      changeIcon = 'linkedin';

    } else if (guilty.indexOf('github') >= 0) {
      var github2Link = event.target.value;
      githubLink.href = 'https://github.com/' + github2Link;
      changeIcon = 'github';
    }

    var icon2Toggle = document.querySelector("." + changeIcon);

    if (event.target.value === "") {
      icon2Toggle.style.display = 'none';
    } else {
      icon2Toggle.style.display = 'flex';
    }
    event.stopPropagation();
  }
}
'use strict';

var fr = new FileReader();
var fotoURL;

var uploadBtn = document.querySelector('.añadir__upload-btn');
var fileField = document.querySelector('#img-selector');
var profileImage = document.querySelector('.card__pic');
var miniBox = document.querySelector('.mini');

function getImage(e) {
  var myFile = e.currentTarget.files[0];
  fr.addEventListener('load', writeImage);
  fr.readAsDataURL(myFile);
}

function writeImage() {
  fotoURL = 'url(' + fr.result + ')';
  profileImage.style.backgroundImage = 'url(' + fr.result + ')';
  miniBox.style.backgroundImage = 'url(' + fr.result + ' )';
  guardarDataLS()
}

function fakeFileClick() {
  fileField.click();
}
fileField.addEventListener('change', getImage);
uploadBtn.addEventListener('click', fakeFileClick);
'use strict';
/* global profileImage miniBox */

var resetButton = document.querySelector('.reset');
var nameFilled = document.querySelector('.card__name--name');
var roleFilled = document.querySelector('.card__job--job');
var iconsRemove = document.querySelectorAll('.card__foot--icon');
var formRemove = document.querySelectorAll('.fieldset__rellena--input');
// var colorRemove = document.querySelector('#')
function resetAll() {
  // // paleta reset
  // card.classList.remove('paleta-azul', 'paleta-roja', 'paleta-gris');
  // card.classList.add('paleta-azul');
  // // font reset
  // cardInfo.classList.remove('font-card--comicsans', 'font-card--ubuntu', 'font-card--montserrat');
  // cardInfo.classList.add('font-card--comicsans');

  // reset nombre y role
  nameFilled.innerHTML = 'Nombre Apellido';
  roleFilled.innerHTML = 'Descripcion';

  //reset pic
  profileImage.style.backgroundImage = 'url(../images/pollito.png)';
  miniBox.style.backgroundImage = 'url(../images/pollito.png)';

  // quitar iconos
  for (var i = 0; i<iconsRemove.length; i++){
    iconsRemove[i].style.display = 'none';
  }
  //quitar vlaores introducidos en el formulario

  for (var i = 0; i < formRemove.length; i++) {
    formRemove[i].value = '';
  }
}
resetButton.addEventListener('click', resetAll);


'use strict';

var nameField = document.querySelector('.fieldset--name');
var roleField = document.querySelector('.fieldset--role');

function writeData(event){
  var guiltyElement = event.currentTarget;
  var targetID = guiltyElement.getAttribute('data-donde');
 document.querySelector('#' + targetID).innerHTML = guiltyElement.value;
}
nameField.addEventListener('keyup', writeData);
roleField.addEventListener('keyup', writeData);
'use strict';

var nombreVisor = document.querySelector('#element-name');
var puestoVisor = document.querySelector('#element-role');
var borderVisor = document.querySelector('.card__head--border');
var iconBorderVisor = document.querySelector('.card__foot--icon');
var iconVisor = document.querySelector('.iconsocial');
var habilidadesVisor = document.querySelector('.card__foot--text');
var colorVisor = document.querySelectorAll('.diseña__colores--paleta');
var fuenteVisor = document.querySelectorAll('.diseña__fuentes');
var color1 = '$dark-green-blue';
var color2 = '$dirty-blue';
var color3 = '$hospital-green';

function definirColores() {
  borderVisor.style.borderLeft = '5px solid' + color3;
  iconBorderVisor.style.border = '2px solid '
  color3;
  iconVisor = color1;
  habilidadesVisor = color2;
  nombreVisor = color1;
}


function cambiarColor(event) {
  var colores = event.currentTarget.id;
  if (colores === 'red') {
    var color1 = '$dark-green-blue';
    var color2 = '$dirty-blue';
    var color3 = '$hospital-green';

  }
}

function cambiarFuente() {
  teste();
}

for (var i = 0; i < colorVisor.length; i++) {
  colorVisor[i].addEventListener('click', cambiarColor);
}
for (var i = 0; i < fuenteVisor.length; i++) {
  fuenteVisor[i].addEventListener('click', cambiarFuente);
}
'use strict';
/* global nameField roleField profileImage inputEmail inputTelefono inputLinkedin inputGithub miniBox fotoURL */

// Funciones localstorage

var infoTarjeta = {};
var habilidade1LocalStorage;
var habilidade2LocalStorage;
var habilidade3LocalStorage;

function verifySelectValues() {
  infoTarjeta = JSON.parse(localStorage.getItem('Profile-Card'));
  if (infoTarjeta.habilidade1) {
    habilidade1LocalStorage = infoTarjeta.habilidade1;
  } else {
    habilidade1LocalStorage = '';
  }
  if (infoTarjeta.habilidade2) {
    habilidade2LocalStorage = infoTarjeta.habilidade2;
  } else {
    habilidade2LocalStorage = '';
  }
  if (infoTarjeta.habilidade3) {
    habilidade3LocalStorage = infoTarjeta.habilidade3;
  } else {
    habilidade3LocalStorage = '';
  }


}
// var habilidade2 = document.querySelector('.select__habilidades2');
// var habilidade3 = document.querySelector('.select__habilidades3');



// -------------------- addEventListeners para los input, para guardar el texto en LS
nameField.addEventListener('focusout', guardarDataLS);
roleField.addEventListener('focusout', guardarDataLS);
inputEmail.addEventListener('focusout', guardarDataLS);
inputTelefono.addEventListener('focusout', guardarDataLS);
inputLinkedin.addEventListener('focusout', guardarDataLS);
inputGithub.addEventListener('focusout', guardarDataLS);

function guardarDataLSSelect(event) {

  var guilty = event.currentTarget;

  if (guilty.name === 'Habilidade1') {
    habilidade1LocalStorage = guilty.value;
    console.log(guilty.name + guilty.value);

  } else if (guilty.name === 'Habilidade2') {

    habilidade2LocalStorage = guilty.value;

  } else if (guilty.name === 'Habilidade3') {
    habilidade3LocalStorage = guilty.value;
  }

  guardarDataLS()
}


function guardarDataLS() {

  if (!localStorage.getItem('Profile-Card')) {
    infoTarjeta = {
      'nombre': '',
      'puesto': '',
      'foto': '',
      'email': '',
      'telefono': '',
      'linkedin': '',
      'github': '',
      'habilidade1': '',
      'habilidade2': '',
      'habilidade3': '',
      'color': '',
      'fuente': ''
    }

  } else {
    infoTarjeta = JSON.parse(localStorage.getItem('Profile-Card'));
  }

  infoTarjeta.nombre = nameField.value;
  infoTarjeta.puesto = roleField.value;
  infoTarjeta.foto = fotoURL;
  infoTarjeta.email = inputEmail.value;
  infoTarjeta.telefono = inputTelefono.value;
  infoTarjeta.linkedin = inputLinkedin.value;
  infoTarjeta.github = inputGithub.value;
  infoTarjeta.habilidade1 = habilidade1LocalStorage;
  infoTarjeta.habilidade2 = habilidade2LocalStorage;
  infoTarjeta.habilidade3 = habilidade3LocalStorage;
  infoTarjeta.color = null
  infoTarjeta.fuente = null

  localStorage.setItem('Profile-Card', JSON.stringify(infoTarjeta));
}

function recuperarDataLS() {
  if (localStorage.getItem('Profile-Card')) {
    infoTarjeta = JSON.parse(localStorage.getItem('Profile-Card'));
    verifySelectValues()
    nameField.value = infoTarjeta.nombre;
    roleField.value = infoTarjeta.puesto;
    profileImage.style.backgroundImage = infoTarjeta.foto;
    miniBox.style.backgroundImage = infoTarjeta.foto;
    profileImage.value = infoTarjeta.foto;
    inputEmail.value = infoTarjeta.email;
    inputTelefono.value = infoTarjeta.telefono;
    inputLinkedin.value = infoTarjeta.linkedin;
    inputGithub.value = infoTarjeta.github;

    loadSelect();
    setTimeout(determineSelectsValuesOnRecoverData, 1000);

  } else {
    loadSelect();
  }
}

function determineSelectsValuesOnRecoverData() {
  if (infoTarjeta.habilidade1 !== '') {
    console.log(infoTarjeta.habilidade1);
    document.querySelector('.select__habilidades1').value = infoTarjeta.habilidade1;
  }
  if (infoTarjeta.habilidade2 !== '') {
    createSelect(); // problema con ese segundo createSelect(). El event change de habilidad1 se lía
    console.log(infoTarjeta.habilidade2);
    document.querySelector('.select__habilidades2').value = infoTarjeta.habilidade2;
  }
  if (infoTarjeta.habilidade3 !== '') {
    createSelect();
    console.log(infoTarjeta.habilidade3);
    document.querySelector('.select__habilidades3').value = infoTarjeta.habilidade3;
  }

}

// -------------- Se ejecuta al iniciar la página
recuperarDataLS()
//# sourceMappingURL=main.min.js.map
